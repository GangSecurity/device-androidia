domainGroup: Routing.Smartx.Start

	#########################################
	############### StreamPath###############
	#########################################

	RoutageState Includes StreamPath

	domainGroup: Capture

		domain: StartRZs
			conf: Start
				ANY
					OpenedCaptureRoutes Includes EavbMicPair1
					OpenedCaptureRoutes Includes EavbMicPair2

				/Audio/smartx/routing_zones/eavb_record_rz/started = 1

			conf: Stop
				/Audio/smartx/routing_zones/eavb_record_rz/started = 0

		domain: EAVBCaptureDevice
			conf: StartEavbMicPair1
				OpenedCaptureRoutes Includes EavbMicPair1

				/Audio/smartx/avb_audio_source_devices/eavb_mic_pair1/started = 1
				/Audio/smartx/avb_audio_source_devices/eavb_mic_pair2/started = 0

			conf: StartEavbMicPair2
				OpenedCaptureRoutes Includes EavbMicPair2

				/Audio/smartx/avb_audio_source_devices/eavb_mic_pair1/started = 0
				/Audio/smartx/avb_audio_source_devices/eavb_mic_pair2/started = 1

			conf: Stop
				/Audio/smartx/avb_audio_source_devices/eavb_mic_pair1/started = 0
				/Audio/smartx/avb_audio_source_devices/eavb_mic_pair2/started = 0

	domainGroup: Playback

		domain: StartBaseRZs
			conf: Start
				ANY
					OpenedCaptureRoutes Includes BtHfp
					OpenedPlaybackRoutes Includes EavbMedia
					OpenedPlaybackRoutes Includes EavbNavigation
					OpenedPlaybackRoutes Includes EavbHmi
					OpenedCaptureRoutes Includes EavbStream
					OpenedCaptureRoutes Includes AuxStream
					OpenedCaptureRoutes Includes FMIA
					OpenedCaptureRoutes Includes ModemIA
				/Audio/smartx/routing_zones/amp_rz/started = 1

			conf: Stop
				/Audio/smartx/routing_zones/amp_rz/started = 0

		domain: StartRzHmi
			conf: Start
				AvbServiceState Is Ready
				ANY
					OpenedPlaybackRoutes Includes EavbHmi
					OpenedCaptureRoutes Includes EavbStream

				/Audio/smartx/derived_routing_zones/eavb_hmi_rz/started = 1

			conf: Stop
				/Audio/smartx/derived_routing_zones/eavb_hmi_rz/started = 0

		domain: StartRzNavigation
			conf: Start
				AvbServiceState Is Ready
				ANY
					OpenedPlaybackRoutes Includes EavbNavigation
					OpenedCaptureRoutes Includes EavbStream

				/Audio/smartx/derived_routing_zones/eavb_navigation_rz/started = 1

			conf: Stop
				/Audio/smartx/derived_routing_zones/eavb_navigation_rz/started = 0

		domain: StartMediaRz
			conf: Start
				AvbServiceState Is Ready
				ANY
					OpenedPlaybackRoutes Includes EavbMedia
					OpenedCaptureRoutes Includes EavbStream

				/Audio/smartx/derived_routing_zones/eavb_media_rz/started = 1

			conf: Stop
				/Audio/smartx/derived_routing_zones/eavb_media_rz/started = 0

		domain: EAVBSourceDevice
			conf: Start
				AvbServiceState Is Ready
				OpenedCaptureRoutes Includes EavbStream
				/Audio/smartx/avb_audio_source_devices/eavb_media/started = 1
				/Audio/smartx/avb_audio_source_devices/eavb_navigation/started = 1
				/Audio/smartx/avb_audio_source_devices/eavb_hmi/started = 1

			conf: Stop
				/Audio/smartx/avb_audio_source_devices/eavb_media/started = 0
				/Audio/smartx/avb_audio_source_devices/eavb_navigation/started = 0
				/Audio/smartx/avb_audio_source_devices/eavb_hmi/started = 0

		domain: AUXSourceDevice
			conf: Start
				OpenedCaptureRoutes Includes AuxStream
				/Audio/smartx/audio_source_devices/aux_in/started = 1

			conf: Stop
				/Audio/smartx/audio_source_devices/aux_in/started = 0

		domainGroup: ToBtHfpOut
			confType: Start
				OpenedCaptureRoutes Includes BtHfp

			domain: 8kHz
				conf: Start
					HfpClientBandType Is NB
					/Audio/smartx/routing_zones/bt_hfp_out_8k_rz/started = 1

				conf: Stop
					/Audio/smartx/routing_zones/bt_hfp_out_8k_rz/started = 0

			domain: 16kHz
				conf: Start
					HfpClientBandType Is WB
					/Audio/smartx/routing_zones/bt_hfp_out_16k_rz/started = 1

				conf: Stop
					/Audio/smartx/routing_zones/bt_hfp_out_16k_rz/started = 0

		domain: ToModemOut
			conf: Start
				OpenedCaptureRoutes Includes ModemIA
				/Audio/smartx/routing_zones/modem_out_rz/started = 1

			conf: Stop
				/Audio/smartx/routing_zones/modem_out_rz/started = 0

		domain: MicSourceDevice
			conf: Start
				ANY
					OpenedCaptureRoutes Includes BtHfp
					OpenedCaptureRoutes Includes ModemIA
				/Audio/smartx/audio_source_devices/mic/started = 1

			conf: Stop
				/Audio/smartx/audio_source_devices/mic/started = 0

		domainGroup: BtHfpInSourceDevice
			confType: Start
				OpenedCaptureRoutes Includes BtHfp

			domain: 8kHz
				conf: Start
					HfpClientBandType Is NB
					/Audio/smartx/audio_source_devices/bt_hfp_in:8000/started = 1

				conf: Stop
					/Audio/smartx/audio_source_devices/bt_hfp_in:8000/started = 0

			domain: 16kHz
				conf: Start
					HfpClientBandType Is WB
					/Audio/smartx/audio_source_devices/bt_hfp_in:16000/started = 1

				conf: Stop
					/Audio/smartx/audio_source_devices/bt_hfp_in:16000/started = 0

		domain: TunerSourceDevice
			conf: Start
				OpenedCaptureRoutes Includes FMIA
				/Audio/smartx/audio_source_devices/tuner/started = 1

			conf: Stop
				/Audio/smartx/audio_source_devices/tuner/started = 0

		domain: ModemSourceDevice
			conf: Start
				OpenedPlaybackRoutes Includes ModemIA
				/Audio/smartx/audio_source_devices/modem_in/started = 1

			conf: Stop
				/Audio/smartx/audio_source_devices/modem_in/started = 0

domainGroup: Routing.Smartx.PostPath

	#########################################
	############   PostPath    ##############
	#########################################

	RoutageState Includes PostPath

	domainGroup: Playback

		domain: SmartXToAVBMedia
			conf: Bind
				AvbServiceState Is Ready
				OpenedPlaybackRoutes Includes EavbMedia
				/Audio/smartx/audio_ports/eavb_media_rz_port/connected_to = media_stream_port

			conf: Unbind
				/Audio/smartx/audio_ports/eavb_media_rz_port/connected_to =

		domain: SmartXToAVBNavigation
			conf: Bind
				AvbServiceState Is Ready
				OpenedPlaybackRoutes Includes EavbNavigation
				/Audio/smartx/audio_ports/eavb_navigation_rz_port/connected_to = navigation_stream_port

			conf: Unbind
				/Audio/smartx/audio_ports/eavb_navigation_rz_port/connected_to =

		domain: SmartXToAVBHmi
			conf: Bind
				AvbServiceState Is Ready
				OpenedPlaybackRoutes Includes EavbHmi
				/Audio/smartx/audio_ports/eavb_hmi_rz_port/connected_to = hmi_stream_port

			conf: Unbind
				/Audio/smartx/audio_ports/eavb_hmi_rz_port/connected_to =


		# TODO: Create configuration that allows mixing sound from both eAVB and AUX IN
		# Currently in case that both IsEAVBStream and AuxInSelected are set to true
		# only eAVB stream will have access to speakers
		domainGroup: Amplifier
			domain: MediaAmpPort
				conf: BindBtHfpIn_8k
					OpenedCaptureRoutes Includes BtHfp
					HfpClientBandType Is NB

					/Audio/smartx/audio_ports/media_amp_rz_port/connected_to = bt_hfp_in_8k_port

				conf: BindBtHfpIn_16k
					OpenedCaptureRoutes Includes BtHfp
					HfpClientBandType Is WB

					/Audio/smartx/audio_ports/media_amp_rz_port/connected_to = bt_hfp_in_16k_port

				conf: BindLocalStream
					OpenedPlaybackRoutes Includes EavbMedia
					ANY
						VehicleAudioFocus Includes Music
						VehicleAudioFocus Includes Alarm
						VehicleAudioFocus Is none

					/Audio/smartx/audio_ports/media_amp_rz_port/connected_to = media_stream_port

				conf: BindEavbStream
					AvbServiceState Is Ready
					OpenedCaptureRoutes Includes EavbStream

					/Audio/smartx/audio_ports/media_amp_rz_port/connected_to = eavb_media_source_port

				conf: BindAux
					OpenedCaptureRoutes Includes AuxStream

					/Audio/smartx/audio_ports/media_amp_rz_port/connected_to = aux_in_port

				conf: BindTuner
					OpenedCaptureRoutes Includes FMIA

					/Audio/smartx/audio_ports/media_amp_rz_port/connected_to = tuner_port

				conf: BindModem
					OpenedPlaybackRoutes Includes ModemIA

					/Audio/smartx/audio_ports/media_amp_rz_port/connected_to = modem_in_port

				conf: Unbind
					/Audio/smartx/audio_ports/media_amp_rz_port/connected_to =

			domain: NavigationAmpPort
				conf: BindLocalStream
					OpenedPlaybackRoutes Includes EavbNavigation

					/Audio/smartx/audio_ports/navigation_amp_rz_port/connected_to = navigation_stream_port

				conf: BindEavbStream
					AvbServiceState Is Ready
					OpenedCaptureRoutes Includes EavbStream

					/Audio/smartx/audio_ports/navigation_amp_rz_port/connected_to = eavb_navigation_source_port

				conf: Unbind
					/Audio/smartx/audio_ports/navigation_amp_rz_port/connected_to =

			domain: HmiAmpPort
				conf: BindLocalStream
					OpenedPlaybackRoutes Includes EavbHmi

					/Audio/smartx/audio_ports/hmi_amp_rz_port/connected_to = hmi_stream_port

				conf: BindEavbStream
					AvbServiceState Is Ready
					OpenedCaptureRoutes Includes EavbStream

					/Audio/smartx/audio_ports/hmi_amp_rz_port/connected_to = eavb_hmi_source_port

				conf: Unbind
					/Audio/smartx/audio_ports/hmi_amp_rz_port/connected_to =

		domainGroup: ToBtHfpOut
			confType: Bind
				OpenedCaptureRoutes Includes BtHfp
				MicMuted Is False

			domain: Mic_8kHz
				conf: Bind
					HfpClientBandType Is NB
					/Audio/smartx/audio_ports/bt_hfp_out_8k_rz_port/connected_to = mic_port

				conf: Unbind
					/Audio/smartx/audio_ports/bt_hfp_out_8k_rz_port/connected_to =

			domain: Mic_16kHz
				conf: Bind
					HfpClientBandType Is WB
					/Audio/smartx/audio_ports/bt_hfp_out_16k_rz_port/connected_to = mic_port

				conf: Unbind
					/Audio/smartx/audio_ports/bt_hfp_out_16k_rz_port/connected_to =

		domainGroup: Capture
			domain: AVBCapture
				conf: BindAVBMic1
					OpenedCaptureRoutes Includes EavbMicPair1

					/Audio/smartx/audio_ports/eavb_record_rz_port/connected_to = eavb_mic1_source_port

				conf: BindAVBMic2
					OpenedCaptureRoutes Includes EavbMicPair2

					/Audio/smartx/audio_ports/eavb_record_rz_port/connected_to = eavb_mic2_source_port

				conf: Unbind
					/Audio/smartx/audio_ports/eavb_record_rz_port/connected_to =


		domain: ToModemOut
			conf: Bind
				OpenedCaptureRoutes Includes ModemIA
				MicMuted Is False

				/Audio/smartx/audio_ports/modem_out_rz_port/connected_to = mic_port

			conf: Unbind
				/Audio/smartx/audio_ports/modem_out_rz_port/connected_to =

domainGroup: Routing.Smartx.Flow

	#########################################
	############### StreamPath###############
	#########################################

	RoutageState Includes Flow

	domain: DataProbing
		conf: Start
			SmartXDataProbing Is True
			ANY
				OpenedPlaybackRoutes Includes EavbMedia
				OpenedPlaybackRoutes Includes EavbNavigation
				OpenedPlaybackRoutes Includes EavbHmi

			/Audio/smartx/audio_ports/media_amp_rz_port/data_probing = 1
			/Audio/smartx/audio_ports/hmi_amp_rz_port/data_probing = 1
			/Audio/smartx/audio_ports/navigation_amp_rz_port/data_probing = 1
			/Audio/smartx/audio_ports/eavb_hmi_rz_port/data_probing = 1
			/Audio/smartx/audio_ports/eavb_media_rz_port/data_probing = 1
			/Audio/smartx/audio_ports/eavb_navigation_rz_port/data_probing = 1

		conf: Stop
			/Audio/smartx/audio_ports/media_amp_rz_port/data_probing = 0
			/Audio/smartx/audio_ports/hmi_amp_rz_port/data_probing = 0
			/Audio/smartx/audio_ports/navigation_amp_rz_port/data_probing = 0
			/Audio/smartx/audio_ports/eavb_hmi_rz_port/data_probing = 0
			/Audio/smartx/audio_ports/eavb_media_rz_port/data_probing = 0
			/Audio/smartx/audio_ports/eavb_navigation_rz_port/data_probing = 0
